<div class="users-container">

  <div class="actions">
    <button (click)="addUser()">+ Nuevo Usuario</button>
    <button (click)="openSearch()">ğŸ” Buscar</button>
    <button (click)="forceReload()" [disabled]="isLoading">
      {{ isLoading ? 'âŸ³ Cargando...' : 'ğŸ”„ Actualizar' }}
    </button>
  </div>

  <!-- Estado de carga -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner">âŸ³</div>
    <p>Cargando usuarios...</p>
  </div>

  <!-- Mensaje de error -->
  <div *ngIf="errorMessage && !isLoading" class="error-state">
    <p>âŒ {{ errorMessage }}</p>
    <button (click)="loadUsers()">Reintentar</button>
  </div>

  <!-- Tabla de usuarios -->
  <div class="table-wrapper" *ngIf="!isLoading && !errorMessage">
    <table>
      <thead>
        <tr>
          <th>IdentificaciÃ³n</th>
          <th>Bloqueado</th>
          <th>Usuario</th>
          <th>Email</th>
          <th>Email Confirmado</th>
          <th>ContraseÃ±a</th>
          <th>Roles</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let user of users">
          <td>{{ user.identificationNumber }}</td>
          <td>
            <span [class.locked]="user.isLocked" [class.unlocked]="!user.isLocked">
              {{ user.isLocked ? 'SÃ­' : 'No' }}
            </span>
          </td>
          <td>{{ user.userName }}</td>
          <td>{{ user.email }}</td>
          <td>
            <span [class.active]="user.emailConfirmed" [class.inactive]="!user.emailConfirmed">
              {{ user.emailConfirmed ? 'SÃ­' : 'No' }}
            </span>
          </td>
          <td>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</td>
        
          <td>
            <span *ngIf="user.roles && user.roles.length; else noRoles">
              {{ user.roles.join(', ') }}
            </span>
            <ng-template #noRoles>Sin roles</ng-template>
          </td>
          <td>
            <button (click)="editUser(user)">âœ</button>
            <button (click)="deleteUser(user.id)">ğŸ—‘</button>
            <button *ngIf="user.isLocked" (click)="unlockUser(user.id)">ğŸ”“</button>
          </td>
        </tr>
        <tr *ngIf="users.length === 0">
          <td colspan="8" class="no-data">No hay usuarios registrados</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
